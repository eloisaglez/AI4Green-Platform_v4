<!DOCTYPE html>
<html lang="{{ site.lang | default: 'es' }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title | default: site.title }}</title>
    <meta name="description" content="{{ page.description | default: site.description }}">
    
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital@1&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --sidebar-width: 300px;
            --bg-green: #0a4f4f;
            --accent: #fec107;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body, html { 
            height: 100%; 
            width: 100%; 
            font-family: 'Montserrat', sans-serif;
        }

        /* SIDEBAR FIJO */
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--bg-green);
            background-image: url('https://images.unsplash.com/photo-1518173946687-a4c8892bbd9f?auto=format&fit=crop&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 60px 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 100;
            overflow-y: auto;
            transition: transform 0.8s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* SOLO ocultar sidebar en home cuando NO se ha hecho click en intro */
        body.home-page:not(.show-content) .sidebar {
            transform: translateX(-100%);
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 79, 79, 0.85);
            z-index: 0;
        }

        .sidebar > * {
            position: relative;
            z-index: 1;
        }

        .logo-container {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-hy {
            font-family: 'Libre Baskerville', serif;
            font-size: 4rem;
            font-style: normal;
            font-weight: normal;
            border-bottom: 3px solid white;
            display: inline-block;
            padding-bottom: 5px;
        }

        .sidebar h2 { 
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            margin-top: 20px;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .sidebar .tagline {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 50px;
            text-align: center;
        }

        .side-nav {
            width: 100%;
            text-align: center;
        }

        .side-nav a { 
            color: white;
            text-decoration: none;
            display: block;
            margin-bottom: 20px;
            font-size: 1rem;
            transition: all 0.3s;
            padding: 8px 0;
            border-bottom: 2px solid transparent;
        }

        .side-nav a:hover,
        .side-nav a.active { 
            color: var(--accent);
            border-bottom-color: var(--accent);
        }

        .social-icons {
            margin-top: auto;
            display: flex;
            gap: 20px;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .social-icons a {
            color: white;
            font-size: 1.3rem;
            transition: 0.3s;
        }

        .social-icons a:hover {
            color: var(--accent);
        }

        /* CONTENIDO */
        .main-content {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
            background: white;
            padding: 80px 10%;
            color: #333;
            transition: background 0.3s, color 0.3s, margin-left 0.8s cubic-bezier(0.23, 1, 0.32, 1);
        }

        /* SOLO en home sin contenido visible, el main no tiene margen */
        body.home-page:not(.show-content) .main-content {
            margin-left: 0;
        }

        body.dark-mode .main-content {
            background: #1a1a1a;
            color: #e0e0e0;
        }

        .content-header {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        body.dark-mode .content-header {
            border-bottom-color: #333;
        }

        .btn-icon {
            background: none;
            border: 1px solid #ddd;
            width: 40px;
            height: 40px;
            border-radius: 4px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }

        .btn-icon:hover {
            background: #f0f0f0;
            border-color: #999;
        }

        body.dark-mode .btn-icon {
            border-color: #444;
        }

        body.dark-mode .btn-icon:hover {
            background: #2a2a2a;
            border-color: #666;
        }

        body.dark-mode svg.icon-menu,
        body.dark-mode svg.icon-theme,
        body.dark-mode svg.icon-search {
            stroke: #e0e0e0 !important;
        }

        .breadcrumb {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 10px;
        }

        .breadcrumb a {
            color: #28a745;
            text-decoration: none;
        }

        body.dark-mode .breadcrumb {
            color: #999;
        }

        body.dark-mode .breadcrumb a {
            color: var(--accent);
        }

        .main-content h1 { 
            font-family: 'Libre Baskerville', serif;
            font-size: 3.5rem;
            margin-bottom: 30px;
        }

        .main-content h2 {
            font-size: 2rem;
            margin-top: 40px;
            margin-bottom: 20px;
        }

        .main-content h3 {
            font-size: 1.5rem;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        body.dark-mode .main-content h1,
        body.dark-mode .main-content h2,
        body.dark-mode .main-content h3 {
            color: #e0e0e0;
        }

        .main-content p {
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 20px;
        }

        .main-content ul,
        .main-content ol {
            margin-left: 30px;
            margin-bottom: 20px;
        }

        .main-content li {
            margin-bottom: 10px;
            line-height: 1.6;
        }

        .main-content a {
            color: #28a745;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: 0.3s;
        }

        .main-content a:hover {
            border-bottom-color: #28a745;
        }

        body.dark-mode .main-content a {
            color: var(--accent);
        }

        .note {
            background: #fff9e6;
            border-left: 4px solid var(--accent);
            padding: 20px;
            margin: 30px 0;
        }

        .note strong {
            display: block;
            margin-bottom: 10px;
            color: #b8860b;
        }

        /* INTRO PAGE (SOLO HOME) */
        .intro-page {
            margin-left: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.5)), 
                        url('https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&q=80');
            background-size: cover;
            background-position: center;
            cursor: pointer;
        }

        .logo-ai { 
            font-family: 'Libre Baskerville', serif;
            font-size: 5rem;
            font-style: italic;
            border-bottom: 5px solid var(--accent);
        }

        .intro-page .subtitle {
            letter-spacing: 3px;
            margin-top: 20px;
            font-size: 1.2rem;
        }

        .intro-page .hint {
            margin-top: 60px;
            font-size: 0.7rem;
            letter-spacing: 3px;
            opacity: 0.8;
        }

        /* Ocultar intro cuando se hace click */
        body.show-content .intro-page {
            display: none;
        }

        /* OVERLAY DE BÚSQUEDA */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: flex-start;
            justify-content: center;
            padding-top: 100px;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .search-overlay.active {
            display: flex;
        }

        .search-box {
            width: 90%;
            max-width: 600px;
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        body.dark-mode .search-box {
            background: #1a1a1a;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            font-size: 1.2rem;
            border: 2px solid #ddd;
            border-radius: 6px;
            background: white;
            color: #333;
            font-family: 'Montserrat', sans-serif;
            transition: border-color 0.3s;
        }

        body.dark-mode .search-input {
            background: #2a2a2a;
            color: #e0e0e0;
            border-color: #444;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent);
        }

        .search-input::placeholder {
            color: #999;
        }

        .search-results {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .search-result-item {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            cursor: pointer;
            transition: background 0.3s;
        }

        .search-result-item:hover {
            background: #f5f5f5;
        }

        body.dark-mode .search-result-item {
            border-bottom-color: #333;
        }

        body.dark-mode .search-result-item:hover {
            background: #2a2a2a;
        }

        .search-result-title {
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 5px;
        }

        .search-result-excerpt {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.4;
        }

        body.dark-mode .search-result-excerpt {
            color: #999;
        }

        .search-no-results {
            text-align: center;
            padding: 30px;
            color: #999;
        }

        .search-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border: none;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }

        .search-close:hover {
            background: rgba(255,255,255,0.2);
        }

        /* BOTÓN BACK TO TOP */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--accent);
            color: #333;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 999;
        }

        .back-to-top.visible {
            display: flex;
        }

        .back-to-top:hover {
            background: #ffcd38;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        }

        body.dark-mode .back-to-top {
            color: #1a1a1a;
        }

        /* BOTÓN SCROLL TO TOP */
        .scroll-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: var(--accent);
            color: #333;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;  /* Cambiado de none a flex para que siempre se vea */
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 999;
            opacity: 0;  /* Añadido para transición suave */
            visibility: hidden;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: #ffd740;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        }

        body.dark-mode .scroll-to-top {
            color: #1a1a1a;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            :root {
                --sidebar-width: 80px;
            }

            .sidebar {
                padding: 20px 10px;
            }
            
            .logo-hy {
                font-size: 2rem;
            }

            .sidebar h2,
            .sidebar .tagline,
            .side-nav a span {
                display: none;
            }

            .main-content {
                padding: 40px 5%;
            }

            .main-content h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body id="app-body" {% if page.layout == 'home' %}class="home-page"{% endif %}>

    <!-- SIDEBAR FIJO -->
    <aside class="sidebar">
        <div class="logo-container">
            <div class="logo-hy">AI</div>
            <h2>{{ site.title }}</h2>
            <p class="tagline">{{ site.description }}</p>
        </div>

        <nav class="side-nav">
            {% for item in site.menu %}
            <a href="{{ site.baseurl }}{{ item.url }}" {% if page.url == item.url %}class="active"{% endif %}>
                {{ item.title }}
            </a>
            {% endfor %}
        </nav>

        <div class="social-icons">
            <a href="{{ site.social.links[0] }}" aria-label="GitHub" target="_blank">
                <svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor">
                    <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                </svg>
            </a>
            <a href="#" aria-label="Twitter">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                </svg>
            </a>
            <a href="mailto:{{ site.author.email }}" aria-label="Email">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                </svg>
            </a>
            <a href="{{ site.baseurl }}/feed.xml" aria-label="RSS">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6.18 15.64a2.18 2.18 0 0 1 2.18 2.18C8.36 19 7.38 20 6.18 20C5 20 4 19 4 17.82a2.18 2.18 0 0 1 2.18-2.18M4 4.44A15.56 15.56 0 0 1 19.56 20h-2.83A12.73 12.73 0 0 0 4 7.27V4.44m0 5.66a9.9 9.9 0 0 1 9.9 9.9h-2.83A7.07 7.07 0 0 0 4 12.93V10.1z"/>
                </svg>
            </a>
        </div>
    </aside>

    <!-- INTRO PAGE (SOLO EN HOME) -->
    {% if page.layout == 'home' %}
    <section class="intro-page" onclick="showContent()">
        <div class="logo-ai">AI4Green</div>
        <p class="subtitle">{{ page.intro_subtitle | default: "EMPOWERING SUSTAINABILITY WITH AI" }}</p>
        <p class="hint">{{ page.intro_hint | default: "CLICK OR SCROLL TO EXPLORE" }}</p>
    </section>
    {% endif %}

    <!-- CONTENIDO -->
    <main class="main-content">
        <div class="content-header">
            <button class="btn-icon" onclick="window.location.href='{{ site.baseurl }}/'" title="Back to Home">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" class="icon-menu">
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <button class="btn-icon" onclick="toggleDarkMode()" title="Toggle Dark Mode">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" class="icon-theme">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
            </button>
            <button class="btn-icon" onclick="toggleSearch()" title="Search">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" class="icon-search">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </button>
        </div>

        {% if page.breadcrumb %}
        <div class="breadcrumb">
            <a href="{{ site.baseurl }}/">HOME</a> / {{ page.breadcrumb }}
        </div>
        {% endif %}

        {{ content }}

    </main>

    <!-- OVERLAY DE BÚSQUEDA -->
    <div class="search-overlay" id="searchOverlay" onclick="closeSearchIfClickOutside(event)">
        <button class="search-close" onclick="toggleSearch()">×</button>
        <div class="search-box" onclick="event.stopPropagation()">
            <input type="text" class="search-input" id="searchInput" placeholder="Search in site..." oninput="performSearch()" autofocus>
            <div class="search-results" id="searchResults"></div>
        </div>
    </div>

    <!-- BOTÓN BACK TO TOP -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()" title="Back to top">
        ↑
    </button>

    <script>
        const body = document.getElementById('app-body');
        const isHome = {{ page.layout == 'home' | jsonify }};

        // CONTENIDO DE LAS PÁGINAS PARA BÚSQUEDA
        const searchablePages = [
            {
                title: "Home",
                url: "{{ site.baseurl }}/",
                content: "AI4GREEN PROJECT Empowering Sustainability with AI Erasmus+ partnership integrating AI and sustainability in STEAM education"
            },
            {
                title: "Educational Materials",
                url: "{{ site.baseurl }}/materials/",
                content: "Discover our comprehensive collection of AI and sustainability resources designed for STEAM education. AI Fundamentals Introduction to Artificial Intelligence Learn the basics of AI machine learning and their applications in environmental science. Understanding AI concepts Machine learning basics AI ethics and responsible use Environmental applications. Python for AI Get started with Python programming for AI projects. Python basics Data analysis with pandas Visualization with matplotlib Introduction to scikit-learn. Sustainability Topics Climate Change AI Explore how AI can help us understand and combat climate change. Renewable Energy Learn how AI optimizes renewable energy systems. Biodiversity Conservation Discover AI applications in wildlife monitoring and ecosystem protection. Hands-on Projects Project 1 Weather Prediction Model Build your own weather forecasting system using machine learning. Project 2 Energy Consumption Analyzer Create a tool to analyze and optimize energy usage. Project 3 Waste Classification System Develop an AI-powered recycling assistant. Teacher Resources Lesson plans Assessment rubrics Student worksheets Presentation slides"
            },
            {
                title: "Project",
                url: "{{ site.baseurl }}/project/",
                content: "AI4Green Project Erasmus+ Partnership 2024-2027 About the Project AI4Green is an innovative Erasmus+ partnership focused on integrating Artificial Intelligence and sustainability education in STEAM curricula across Europe. Our mission is to empower students and educators with the knowledge and tools to address environmental challenges using AI technologies. Project Goals Develop comprehensive AI and sustainability curriculum materials. Create hands-on learning experiences combining technology and environmental science. Foster international collaboration among students and teachers. Build digital competencies for the green transition. Promote critical thinking about AI ethics and environmental responsibility. Partner Countries Spain Lead Institution IES Diego Velázquez. France École Polytechnique Specialists in AI education and computational thinking. Italy Istituto Tecnico Focus on renewable energy and sustainable technologies. Expected Outcomes Open educational resources for AI in sustainability. Teacher training programs and workshops. Student exchange opportunities. Digital platform for collaborative learning. Case studies and best practices documentation"
            },
            {
                title: "Team",
                url: "{{ site.baseurl }}/team/",
                content: "EcoAI Team Meet the educators researchers and innovators behind the AI4Green project. Project Coordinators IES Diego Velázquez Spain Lead Institution The Technology Department at IES Diego Velázquez brings expertise in STEAM education programming and environmental projects. Key Contributors Eloísa González Medina Technology Department Head Expert in Python Arduino and educational technology STEMadrid Network member. Partner Schools École Polytechnique France Specialists in AI education and computational thinking. Istituto Tecnico Italy Experts in renewable energy integration and sustainable engineering. Student Representatives Active participants in project development and testing. Contact Information For inquiries about the AI4Green project please contact us through our partner institutions or via the project coordination team"
            }
        ];

        function showContent() {
            body.classList.add('show-content');
        }

        // MODO OSCURO
        function toggleDarkMode() {
            body.classList.toggle('dark-mode');
            if (body.classList.contains('dark-mode')) {
                localStorage.setItem('darkMode', 'enabled');
            } else {
                localStorage.setItem('darkMode', 'disabled');
            }
        }

        // Cargar preferencia de modo oscuro
        if (localStorage.getItem('darkMode') === 'enabled') {
            body.classList.add('dark-mode');
        }

        // BÚSQUEDA
        function performSearch() {
            const query = document.getElementById('searchInput').value.toLowerCase().trim();
            const resultsContainer = document.getElementById('searchResults');
            
            if (query.length < 2) {
                resultsContainer.innerHTML = '';
                return;
            }

            const results = searchablePages.filter(page => {
                return page.title.toLowerCase().includes(query) || 
                       page.content.toLowerCase().includes(query);
            });

            if (results.length === 0) {
                resultsContainer.innerHTML = '<div class="search-no-results">No results found</div>';
                return;
            }

            let html = '';
            results.forEach(result => {
                // Encontrar el contexto alrededor de la palabra encontrada
                const contentLower = result.content.toLowerCase();
                const index = contentLower.indexOf(query);
                let excerpt = '';
                
                if (index !== -1) {
                    const start = Math.max(0, index - 50);
                    const end = Math.min(result.content.length, index + query.length + 50);
                    excerpt = '...' + result.content.substring(start, end) + '...';
                    
                    // Resaltar la palabra buscada
                    const regex = new RegExp(`(${query})`, 'gi');
                    excerpt = excerpt.replace(regex, '<strong>$1</strong>');
                } else {
                    // Si no está en el contenido, mostrar el inicio
                    excerpt = result.content.substring(0, 100) + '...';
                }

                html += `
                    <div class="search-result-item" onclick="window.location.href='${result.url}'">
                        <div class="search-result-title">${result.title}</div>
                        <div class="search-result-excerpt">${excerpt}</div>
                    </div>
                `;
            });

            resultsContainer.innerHTML = html;
        }

        function toggleSearch() {
            const searchOverlay = document.getElementById('searchOverlay');
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            
            if (searchOverlay.classList.contains('active')) {
                searchOverlay.classList.remove('active');
                searchInput.value = '';
                searchResults.innerHTML = '';
            } else {
                searchOverlay.classList.add('active');
                setTimeout(() => searchInput.focus(), 100);
            }
        }

        function closeSearchIfClickOutside(event) {
            if (event.target.id === 'searchOverlay') {
                toggleSearch();
            }
        }

        // Cerrar búsqueda con ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const searchOverlay = document.getElementById('searchOverlay');
                if (searchOverlay.classList.contains('active')) {
                    toggleSearch();
                }
            }
        });

        // SCROLL TO TOP
        const scrollToTopBtn = document.getElementById('backToTop');

        // Mostrar/ocultar botón según scroll
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 100) {
                scrollToTopBtn.classList.add('visible');
            } else {
                scrollToTopBtn.classList.remove('visible');
            }
        });

        // También detectar scroll en .main-content (para páginas con contenido largo)
        const mainContent = document.querySelector('.main-content');
        if (mainContent) {
            mainContent.addEventListener('scroll', () => {
                if (mainContent.scrollTop > 100) {
                    scrollToTopBtn.classList.add('visible');
                } else {
                    scrollToTopBtn.classList.remove('visible');
                }
            });
        }

        // Función para scroll suave hacia arriba
        function scrollToTop() {
            // Scroll en la ventana principal
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });

            // Scroll en el contenido principal
            if (mainContent) {
                mainContent.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }
        }
    </script>
</body>
</html>
